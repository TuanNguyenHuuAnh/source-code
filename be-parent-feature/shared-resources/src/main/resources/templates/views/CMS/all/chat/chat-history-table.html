<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
	<body th:fragment="content">
		<div class="col-sm-12">
			<h2 class="sub-header section-heading" th:text="#{search.results.title}">Kết quả tìm kiếm</h2>
			<span class="pull-right">
				<button class="btn-common" type="button" id="exportHistory">
						<i class="fa fa-download" aria-hidden="true"></i>
						<span th:text="#{document.versionlist.download}">Tải về</span>
				</button>
			</span>
			<div class="clearfix"></div>
			<div class="table-responsive">
				<table class="table table-bordered table-hover out-tbl">
					<thead>
						<tr>	
							<th class="u_t_no">#</th>
							<th class="u_t_action" th:text="#{action.label}">Thao tác</th>
							<th th:text="#{chat.list.agent}">Nhân viên hỗ trợ</th>
							<th th:text="#{chat.list.fullname}">Tên khách hàng</th>
							<th th:text="#{chat.list.email}">Email</th>
							<th th:text="#{chat.list.phone}">Số điện thoại</th>  
							<th th:text="#{chat.list.service}">Dịch vụ</th>
							<th th:text="#{chat.list.date.create}">Thời gian bắt đầu</th>
							<th th:text="#{chat.list.date.disconnect}">Thời gian kết thúc</th>
							<th th:text="#{chat.list.total.support}">Thời gian hỗ trợ</th>
							<th th:text="#{chat.list.type.disconnect}">Loại ngắt kết nối</th>
						</tr>
					</thead>
					<tbody>
						<th:block th:each="dataRow,i : ${pageWrapper.data}" th:with="startIndex=${pageWrapper.startIndexCurrent}">
							<tr th:attr="data-agent=${dataRow.agent}, data-clientid=${dataRow.clientid}">
								<td th:text="${i.index + startIndex}" style="text-align:center"></td>
								<td class="align-center">
									<i class="glyphicon glyphicon-eye-open custom-icon j-btn-detail" title="Chi tiết"
									   th:if="((${dataRow.countMessage != null} and ${dataRow.countMessage != 0}) or ${dataRow.agent != null}) 
									   			and (${dataRow.agent} == ${account.username} or ${isAdmin == 1})">
									</i>
									<!-- <i class="glyphicon glyphicon-edit custom-icon j-btn-edit"></i> -->
								</td>
								<td th:text="${dataRow.agentName}"></td>
								<td style="width:200px;" th:text="${dataRow.fullname}"></td>
								<td th:text="${dataRow.email}"></td>
								<td th:text="${dataRow.phone}"></td>
								<td th:text="${dataRow.service}"></td>
								<td style="text-align:center;width:130px;" >
									<div  th:if="${dataRow.createdDate != null}">
										<span th:text="${#dates.format(dataRow.createdDate, 'dd/MM/yyyy  HH:mm:ss')}"></span>
									</div>
								</td>
								<td style="text-align:center" >
									<div th:if="${dataRow.disconnectedDate != null}">
										<span th:text="${#dates.format(dataRow.disconnectedDate, 'dd/MM/yyyy  HH:mm:ss')}"></span>
									</div>
								</td>
								
                               <td style="text-align:left" >
                                    <span th:text="${dataRow.totalSupport}" th:if="(${dataRow.countMessage != null} and ${dataRow.countMessage != 0}) or ${dataRow.agent != null}"></span>
                                </td>
                                
                                <td style="text-align: center" th:text="${dataRow.typeDisconnectedName}"></td>		
							</tr>
						</th:block>
					</tbody>
				</table>
			</div>
		</div>
		<th:block th:include="views/commons/pagination.html :: content"/>
		<input type="hidden" id="chatCurrentPage" th:value = "${pageWrapper.currentPage}" />
		<script type="text/javascript" th:src="@{/web-app/views/chat/chat-list-history.js}"></script>
		
</body>
</html>

