<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<body th:fragment="content">
	<form class="form-horizontal u-for-page-top j-form-validate"
		role="form" id="rule-form" method="POST" autocomplete="off"
		th:object="${ruleDto}" th:action="@{/}">
		<div class="bg-content clearfix">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal"
					aria-label="Close" id="closeModal">
					<span aria-hidden="true">&times;</span>
				</button>
				<h2 class="title-box" id="rule-modal-label" th:text="#{jpm.process.rule.information}">Rule Information</h2>
			</div>
			<div class="modal-body">

				<th:block
					th:include="views/commons/message-alert.html :: content(${messageList})" />

				<input type="hidden" th:field="*{id}" /> 
				<input type="hidden" th:field="*{processId}" />
				<input type="hidden" th:field="*{routerId}" />
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label th:for="*{routerId}" class="col-md-3 required" th:text="#{jpm.process.router}">Router</label>
							<div class="col-md-9">
								<select class="form-control j-required" data-show-subtext="true"
									data-live-search="true" th:field="*{routerId}" disabled="true">
									<option th:each="router : ${listRouter}" 
                                    		th:value="${router.id}"
                                    		th:text="${router.name}">
                                    </option>
								</select>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label class="col-md-3" th:text="#{jpm.process.rule.data}">Rule data</label>
							<div class="col-md-9" id="ruleDataBuilder"></div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label th:for="*{expression}" class="col-md-3" th:text="#{jpm.process.rule.expression}">Expression</label>
							<div class="col-md-9">
							 	<input type="text" class="form-control" th:field="*{expression}" readonly="true"/>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label th:for="*{value}" class="col-md-3 required" th:text="#{jpm.process.rule.value}">Value</label>
							<div class="col-md-9" th:unless="${listValue != null and listValue.size()>0}">
							 	<input type="text" class="form-control j-required" th:field="*{value}"/>
							</div>
							<div class="col-md-9" th:if="${listValue != null and listValue.size()>0}">
								<select class="form-control j-required" data-show-subtext="true"
									data-live-search="true" th:field="*{value}">
									<option th:each="value : ${listValue}" 
                                    		th:value="${value.value}"
                                    		th:text="${value.name}">
                                    </option>
								</select>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<label th:for="*{explain}" class="col-md-3" th:text="#{jpm.process.rule.explain}">Explain</label>
							<div class="col-md-9">
							 	<textarea  class="form-control" rows="3" maxlength="511" th:field="*{explain}"></textarea>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal-footer">
			<span class="button"> <a href="#" class="btn btn-cancel"
				data-dismiss="modal" th:text="#{close.button}">Close</a>
			</span>
			<button id="btn-rule-submit" class="btn btn-common btn-in-tablet"
				type="button" th:text="#{save.button}">Save</button>
		</div>
	</form>
	<script th:inline="javascript" type="text/javascript">
		var FILTER = [[${filter}]];
		var rule = [[${ruleDto.ruleData}]];
		
		$("#ruleDataBuilder").queryBuilder({
			  plugins: [
			    'invert',
			    'not-group'
			  ],
			  filters: FILTER,
			  rules: JSON.parse(rule),
			  lang_code: APP_LOCALE.toLowerCase()
	  	});
	</script>
</body>
</html>