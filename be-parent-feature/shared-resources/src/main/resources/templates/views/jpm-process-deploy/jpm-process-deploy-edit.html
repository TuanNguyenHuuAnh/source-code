	<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{templates/unit-layout}"
  layout:fragment="body">
<script type="text/javascript" th:src="@{/static/cache/jquery/jquery.autocomplete.js}"></script>
<div class="title-head">
	<div class="row">
		<div class="col-md-5">
			<h3>
				<span th:text="#{jpm.process.deploy.page}">Tiêu đề trang</span>
			</h3>
		</div>
	   	<div class="col-md-7">
	        <div class="pull-right">
				 <a class="u-btn u-btn-back" id="btnBack">
				 	<img th:src="@{/static/images/icon-down.png}" alt="" width="17px" class="rotate-ico"/>
				 	<span>Trở lại</span>
				 </a>
				 <a class="btn-save u-btn u-btn-primary" id="btnExport" th:href="@{/jpm-process-deploy/export(id=${objectDto.id})}"> 
					<img th:src="@{/static/images/icon-save.png}" alt="" width="19px" class="rotate-180-ico" style="margin-right: 5px!important"/>
					<span>Export</span>
				</a>
	        </div>
	   </div>
	</div>	
</div>



<form class="form-horizontal u-for-page-top j-form-validate" id="form-detail" th:object="${objectDto}" method="post" role="form">

	<th:block th:include="views/commons/message-alert.html :: content(${messageList})" />

	<input type="hidden" th:field="*{id}" id="txtProcessId"/>
	<input type="hidden" id="url" name="url" th:value="${url}" />
	
	<div class="bg-content clearfix">
		<div data-toggle="collapse" data-target="#business-detail" class="header-box">
			<h2 class="title-box" th:if="${objectDto.id == null}" th:text="#{jpm.process.page.name.add}">Add</h2>
            <h2 class="title-box" th:unless="${objectDto.id == null}" th:text="#{jpm.process.page.name}">Update</h2>
			<i class="fa fa-minus pull-right" aria-hidden="true"></i>
		</div>
		<div class="collapse in" id="business-detail">
			<div class="row">
				<div class="col-md-6 p-0">
					<div class="form-group">
						<label for="business-code-id" class="col-sm-4 align-top" th:text="#{jpm.process.code}">Process code</label>
						<div class="col-sm-8" th:classappend="${#fields.hasErrors('code')} ? has-error : ''">
							<input class="form-control j-maxlength j-required j-code" type="text" th:field="*{code}" maxlength="100" readonly="true" />
						</div>
					</div>
					<div class="form-group" th:if="${companyList.size() > 1}">
		                <label for="companyId" class="col-sm-4 align-top" th:text="#{company.detail}">Company</label>
		                <div class="col-sm-8">
		                    <select class="form-control select2 j-required" th:field="*{companyId}" readonly="true" disabled="true">
		                    	<option value=""></option>
		                        <option th:each="company : ${companyList}" 
		                                th:value="${company.id}"
		                                th:text="${company.text}">
		                        </option>
		                    </select>
		                </div>
		            </div>
		            <input th:unless="${companyList.size() > 1}" type="hidden" name="companyId" id="companyId" th:value="${#authentication?.principal?.companyId}" />
					<div class="form-group">
						<label for="effectiveDate" class="col-sm-4 align-top" th:text="#{jpm.process.effective.date}">Effective date</label>
						<div class="col-sm-8">
							<div class="input-group date">
								<input type="text" class="form-control j-required" th:field="*{effectiveDate}" autocomplete="off" readonly="true" disabled="true" /> 
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
							</div>
						</div>
					</div>
					<div class="form-group">
						<label for="description" class="col-sm-4 align-top" th:text="#{jpm.process.description}">Description</label>
						<div class="col-sm-8" th:classappend="${#fields.hasErrors('description')} ? has-error : ''">
							<textarea class="form-control" rows="5" data-rule-maxlength="1000" maxlength="1000" th:inline="text" th:field="*{description}" readonly="true" ></textarea>
						</div>
					</div>
					<!-- <div class="form-group">
						<label for="signType" class="col-sm-4 align-top" th:text="#{jpm.process.step.sign.type}">Sign Type</label>
						<div class="col-sm-8" th:classappend="${#fields.hasErrors('signType')} ? has-error : ''">
							<select class="form-control" th:field="*{signType}" disabled="disabled">
								<option value=""></option>
								<th:block th:each="item: ${T(vn.com.unit.activiti.enumdef.SignTypeEnum).values()}">
									<option th:value="${item.getValue()}" th:text="#{${item.name}}"></option>
								</th:block>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label for="signType" class="col-sm-4 align-top" th:text="#{jpm.process.step.sign.position}">Sign Position</label>
						<div class="col-sm-8" th:classappend="${#fields.hasErrors('signType')} ? has-error : ''">
							<input type="text" class="form-control" readonly="readonly" th:field="*{signPosition}" autocomplete="off"/> 
						</div>
					</div> -->
				</div>
				<div class="col-sm-6 p-0">
					<div class="form-group">
						<label for="name" class="col-sm-4 align-top" th:text="#{jpm.process.name}">Process name</label>
						<div class="col-sm-8">
							<input class="form-control  j-maxlength j-required j-specialCharacters" type="text" th:field="*{name}" maxlength="255" readonly="true" />
						</div>
					</div>
					
					<div class="row">
	                    <div class="col-md-12">
	                        <div class="form-group">
	                            <div class="col-md-offset-4 col-md-8 gr-tab">
	                                <ul class="nav nav-tabs" id="tabSvcLanguage">
	                                    <th:block th:each="language, i : ${languageList}">
	                                        <li role="presentation" th:classappend="${i.index == 0}  ? 'active' : ''" th:id="tabProcessLanguage + ${i.index}">
	                                            <a th:href="'#languageProcess-' + ${language.code}" th:text="${language.name}" data-toggle="tab" aria-expanded="true"></a>
	                                        </li>
	                                    </th:block>
	                                </ul>
	                            </div>
	                        </div>
	                    </div>
	                </div>
	                <div class="tab-content">
	                    <th:block th:each="language, i : ${objectDto.processLangs}" th:with="index=${i.index}">
	                        <div th:id="'languageProcess-' + ${language.langCode}" class="tab-pane fade " th:classappend="${language.langCode == languageList[0].code}  ? 'in active' : ''">
	                            <input th:type="hidden" th:field="*{processLangs[__${index}__].langId}" />
	                            <input th:type="hidden" th:field="*{processLangs[__${index}__].langCode}" />
	                            <div class="row">
	                                <div class="col-md-12">
	                                    <div class="form-group">
	                                        <label th:for="*{processLangs[__${index}__].processName}" class="col-md-4 align-top" th:text="#{jpm.process.name.lang}"></label>
	                                        <div class="col-md-8">
	                                            <input th:field="*{processLangs[__${index}__].processName}" type="text" class="form-control j-maxlength j-required" readonly="readonly" />
	                                        </div>
	                                    </div>
	                                </div>
	                            </div>
	                        </div>
	                    </th:block>
	                </div>
					
					<div class="form-group">
		                <label for="businessId" class="col-sm-4 align-top" th:text="#{jpm.process.business.id}">Business</label>
		                <div class="col-sm-8">
		                    <select class="form-control select2 j-required" th:field="*{businessId}" readonly="true" disabled="true">
		                    	<option value=""></option>
		                        <option th:each="business : ${businessList}" 
		                                th:value="${business.id}"
		                                th:text="${business.text}">
		                        </option>
		                    </select>
		                </div>
		            </div>
		            <!-- <div class="form-group">
						<label for="expiredDate" class="col-sm-4" th:text="#{jpm.process.expired.date}">Expired date</label>
						<div class="col-sm-8">
							<div class="input-group date">
								<input type="text" class="form-control" th:field="*{expiredDate}" autocomplete="off"/> 
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
							</div>
						</div>
					</div> -->
					<div class="form-group" th:if="${objectDto.isWorkflow}">
						<label for="name" class=" col-sm-4 align-top" th:text="#{jpm.process.file.name.bpmn}">File bpmn</label>
						<div class="col-sm-8">
							<div class="input-group">
								<input class="form-control" type="text" th:field="*{fileNameBpmn}" maxlength="255" readonly="readonly" />
								<a class="input-group-addon" style="cursor: pointer;" th:if="*{fileNameBpmn}" th:href="@{/ajax-file/download(filePath=*{filePathBpmn},repositoryId=*{jRepositoryId},fileName=*{fileNameBpmn})}">
									<i class="fa fa-download"></i>
								</a>
							</div>
							<span class="help-block" th:if="${#fields.hasErrors('fileNameBpmn')}" th:errors="*{fileNameBpmn}"></span>
							<span class="help-block alert-fileProcess" style="display:none"></span>
						</div>
					</div>
					<div class="form-group">
						<label for="version" class="col-sm-4 align-top" th:text="#{document.version}">Version</label>
						<div class="col-sm-8">
							<input class="form-control" type="text" name="version" th:readonly="true" th:value="*{majorVersion} + '.' + *{minorVersion}" />
						</div>
					</div> 
					<!-- <div class="form-group">
						<label for="isActive" class="col-sm-4 align-middle" th:text="#{jpm.process.is.active}" >Is active</label>
						<div class="col-sm-8">
							<input type="checkbox" name="isActive" th:field="*{isActive}" disabled="true" />
						</div>
					</div> -->
					<div class="form-group act-process" th:if="${objectDto.processType == 'ACTIVITY'}">
						<div class="col-sm-4">
						</div>
						<div class="col-sm-8">
							<label class="checkbox-inline">
								<input type="checkbox"
								 	name="isShowWorkflow"
								 	th:field="*{isShowWorkflow}" disabled="true"/>
								<span th:text="#{jpm.process.is.show.workflow.diagram}"> </span>
							</label>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</form>

<!--PROCESS CONFIGURATION-->
<div class="bg-content clearfix" th:if="${objectDto.id != null}">
	<div class="header-box" data-target="#configuration">
		<h2 class="title-box">
			<span th:text="#{jpm.process.configuration}">JPM Process Configuration</span>
		</h2>
		<!-- <i class="fa fa-minus pull-right" aria-hidden="true"></i> -->
	</div>

	<div class="row m-0 gr-tab" id="configuration" aria-expanded="false">

		<ul class="nav nav-tabs" id="tabConfiguration">
			<li role="presentation" class="active"><a href="#configuration-param" th:text="#{jpm.process.param}" data-toggle="tab" aria-expanded="true"></a></li>
			<li role="presentation" class=""><a href="#configuration-status" th:text="#{jpm.process.status}" data-toggle="tab" aria-expanded="true"></a></li>
			<li role="presentation" class=""><a href="#configuration-function" th:text="#{jpm.process.function}" data-toggle="tab" aria-expanded="true"></a></li>
			<li role="presentation" class=""><a href="#configuration-button" th:text="#{jpm.process.button}" data-toggle="tab" aria-expanded="true"></a></li>
			<li role="presentation" class=""><a href="#configuration-dmn" th:text="#{jpm.process.dmn}" data-toggle="tab" aria-expanded="true"></a></li>
		</ul>

		<div class="tab-content" style="margin-top: 10px">
		
			<!-- Param -->
			<div id="configuration-param" class="tab-pane fade in active">
				<div class="bg-content-tbl border-tb-0">
					<div class="table-responsive">
						<div id="tableProcessParam">
							<th:block th:include="views/jpm-process-deploy/jpm-process-deploy-param.html :: content"/>
						</div>
					</div>
				</div>
				<div>
					<div class="modal fade" id="param-modal" tabindex="-1" role="dialog" aria-labelledby="param-modal-label">
						<div class="modal-dialog modal-lg" role="document">
							<div class="modal-content" id="param-modal-content">
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Status -->
			<div id="configuration-status" class="tab-pane fade">
				<div class="bg-content-tbl border-tb-0">
					<div class="table-responsive">
						<div id="tableProcessStatus">
							<th:block th:include="views/jpm-process-deploy/jpm-process-deploy-status.html :: content"/>
						</div>
					</div>
				</div>
				<div>
					<div class="modal fade" id="status-modal" tabindex="-1" role="dialog" aria-labelledby="status-modal-label">
						<div class="modal-dialog modal-lg" role="document">
							<div class="modal-content" id="status-modal-content">
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Function -->
			<div id="configuration-function" class="tab-pane fade">
				<div class="bg-content-tbl border-tb-0">
					<div class="table-responsive">
						<div id="tableProcessFunction">
							<th:block th:include="views/jpm-process-deploy/jpm-process-deploy-function.html :: content"/>
						</div>
					</div>
				</div>

				<div>
					<div class="modal fade" id="function-modal" tabindex="-1" role="dialog" aria-labelledby="function-modal-label">
						<div class="modal-dialog modal-lg" role="document">
							<div class="modal-content" id="function-modal-content">
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- Button -->
			<div id="configuration-button" class="tab-pane fade">
				<div class="bg-content-tbl border-tb-0">
					<div class="table-responsive">
						<div id="tableProcessButton">
							<th:block th:include="views/jpm-process-deploy/jpm-process-deploy-button.html :: content"/>
						</div>
					</div>
				</div>

				<div>
					<div class="modal fade" id="button-modal" tabindex="-1" role="dialog" aria-labelledby="button-modal-label">
						<div class="modal-dialog modal-lg" role="document">
							<div class="modal-content" id="button-modal-content">
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- DMN -->
			<div id="configuration-dmn" class="tab-pane fade">
				
				<div class="bg-content-tbl border-tb-0">
					<div class="table-responsive">
						<div id="tableProcessDmn">
							<th:block
								th:include="views/jpm-process-deploy/jpm-process-deploy-dmn.html :: content" />
						</div>
					</div>
				</div>
				<div>
					<div class="modal fade" id="dmn-modal" tabindex="-1"
						role="dialog" aria-labelledby="button-modal-label">
						<div class="modal-dialog" role="document">
							<div class="modal-content" id="button-modal-content"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
</div>

<!--PROCESS MAIN DIAGRAM-->
<div class="bg-content clearfix" th:if="${objectDto.processDefinitionid != null}">
	<div data-toggle="collapse" data-target="#processMainDiagram" class="header-box">
		<h2 class="title-box">
			<span th:text="#{jpm.process.main.diagram}">Workflow Process Diagram</span>
		</h2>
		<i class="fa fa-minus pull-right" aria-hidden="true"></i>
	</div>

	<div class="collapse in row m-0" id="processMainDiagram">
		<img id="imgProcessMainDiagram" class="img-responsive img-rounded" th:src="@{/workflow/diagram/{id}(id=${objectDto.processDefinitionid})}"
                         alt="Workflow Process Diagram" />
	</div>
</div>

<!--PROCESS STEP-->
<div class="bg-content clearfix">
	<div data-toggle="collapse" data-target="#processStep" class="header-box">
		<h2 class="title-box">
			<span th:text="#{jpm.process.step}">Process Step</span>
		</h2>
		<i class="fa fa-minus pull-right" aria-hidden="true"></i>
	</div>

	<div class="collapse in row m-0" id="processStep">
		<div class="bg-content-tbl border-tb-0">
			<div id="tableProcessStep">
				<th:block th:include="views/jpm-process-deploy/jpm-process-deploy-step.html :: content"/>
			</div>
		</div>
	</div>
</div>

<!-- BEGIN TEST -->
<div>
	<div class="modal fade" id="step-modal" tabindex="-1" role="dialog" aria-labelledby="step-modal-label">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content" id="step-modal-content">
			</div>
		</div>
	</div>
</div>
<!-- END TEST -->

<script type="text/javascript" th:src="@{/static/cache/js/jpm-process-deploy/jpm-process-deploy-edit.js}"></script>

</html>
